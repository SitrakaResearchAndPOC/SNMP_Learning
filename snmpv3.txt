Tutoriel : Configurer SNMPv3 dans un conteneur Docker avec net-snmp
‚úÖ Objectif

Mettre en place un agent SNMPv3 s√©curis√© dans un conteneur Ubuntu (ubuntu:24.04) en utilisant :

net-snmp et snmpd

net-snmp-create-v3-user pour cr√©er un utilisateur avec authentification (MD5) et chiffrement (DES)

Tester l‚Äôacc√®s avec snmpwalk

üê≥ √âtape 1 : Lancer le conteneur Docker

docker run -itd --name snmpv3-container --hostname snmpv3-container ubuntu:24.04


√âtape 2 : Installer SNMP et SNMPD
docker exec -it snmpv3-container bash

Puis √† l‚Äôint√©rieur du conteneur :

apt-get update
apt-get install -y snmp snmpd snmp-mibs-downloader



√âtape 3 : Cr√©er un utilisateur SNMPv3

Utilisons l'outil net-snmp-create-v3-user

net-snmp-create-v3-user -ro -a MD5 -A myAuthPass -x DES -X myPrivPass snmpv3user

    -ro : utilisateur en lecture seule

    -a MD5 : algorithme d‚Äôauthentification

    -A : mot de passe d‚Äôauthentification

    -x DES : algorithme de chiffrement

    -X : mot de passe de chiffrement

    snmpv3user : nom d‚Äôutilisateur SNMPv3

‚úÖ Cette commande modifie automatiquement /var/lib/snmp/snmpd.conf pour inclure cet utilisateur.


√âtape 4 : Configurer le fichier /etc/snmp/snmpd.conf

√âdite le fichier :
nano /etc/snmp/snmpd.conf

Et configure-le ainsi :
# D√©sactive l‚Äô√©coute sur IPv6 si non n√©cessaire
agentAddress udp:161

# Infos sur l‚Äôagent
sysLocation "Unknown"
sysContact "Unknown"

# Active SNMPv3 uniquement
createUser snmpv3user MD5 "myAuthPass" DES "myPrivPass"
rouser snmpv3user authPriv

Ici, on interdit tout acc√®s public SNMPv1/v2c en ne mettant pas de rocommunity.

√âtape 5 : D√©marrer SNMPD
service snmpd restart
service snmpd status


√âtape 6 : Tester avec snmpwalk (SNMPv3)
Test de connexion √† l‚Äôagent local :
snmpwalk -v3 -u snmpv3user -a MD5 -A myAuthPass -x DES -X myPrivPass -l authPriv localhost 1.3.6.1.2.1.1

    -v3 : version SNMP

    -u : utilisateur SNMPv3

    -a, -A : auth type et mot de passe

    -x, -X : privacy type et mot de passe

    -l authPriv : niveau de s√©curit√© (authentification + chiffrement)


Exemples sp√©cifiques (SysName, SysLocation, etc.)

SysName

snmpwalk -v3 -u snmpv3user -a MD5 -A myAuthPass -x DES -X myPrivPass -l authPriv localhost 1.3.6.1.2.1.1.5.0

SysLocation

snmpwalk -v3 -u snmpv3user -a MD5 -A myAuthPass -x DES -X myPrivPass -l authPriv localhost 1.3.6.1.2.1.1.6.0

    SysContact

snmpwalk -v3 -u snmpv3user -a MD5 -A myAuthPass -x DES -X myPrivPass -l authPriv localhost 1.3.6.1.2.1.1.4.0
